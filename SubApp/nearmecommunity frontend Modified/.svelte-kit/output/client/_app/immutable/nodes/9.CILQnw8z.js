import{s as Ct,r as Lt,c as It,o as Mt,n as ft,b as Et}from"../chunks/DXpsuylB.js";import{S as Nt,i as St,d as v,l as $,m as V,A as pt,n as mt,a as G,b as s,p as at,r as i,c as g,e as M,v as j,g as E,f as vt,h,j as N,t as _t,k as bt,o as yt,u as xt,w as kt,B as gt}from"../chunks/p7MHL9ij.js";import{u as lt}from"../chunks/dHoYvIwq.js";import{g as nt}from"../chunks/CnkrIbET.js";import{t as W}from"../chunks/DPRAcTLd.js";import{L as wt}from"../chunks/MVhhnn2Y.js";function ht(p){let e,t,o,a,u="Loading map...",l;return t=new wt({props:{size:"lg"}}),{c(){e=h("div"),kt(t.$$.fragment),o=N(),a=h("p"),a.textContent=u,this.h()},l(n){e=g(n,"DIV",{class:!0});var c=M(e);xt(t.$$.fragment,c),o=E(c),a=g(c,"P",{class:!0,"data-svelte-h":!0}),j(a)!=="svelte-1nif57m"&&(a.textContent=u),c.forEach(v),this.h()},h(){i(a,"class","mt-4 text-gray-600 dark:text-gray-300"),i(e,"class","h-full flex flex-col items-center justify-center")},m(n,c){G(n,e,c),yt(t,e,null),s(e,o),s(e,a),l=!0},i(n){l||(V(t.$$.fragment,n),l=!0)},o(n){$(t.$$.fragment,n),l=!1},d(n){n&&v(e),bt(t)}}}function Dt(p){let e;return{c(){e=_t("Save Location")},l(t){e=vt(t,"Save Location")},m(t,o){G(t,e,o)},i:ft,o:ft,d(t){t&&v(e)}}}function Pt(p){let e,t,o,a="Saving...",u;return e=new wt({props:{size:"sm",color:"white"}}),{c(){kt(e.$$.fragment),t=N(),o=h("span"),o.textContent=a,this.h()},l(l){xt(e.$$.fragment,l),t=E(l),o=g(l,"SPAN",{class:!0,"data-svelte-h":!0}),j(o)!=="svelte-10mcier"&&(o.textContent=a),this.h()},h(){i(o,"class","ml-2")},m(l,n){yt(e,l,n),G(l,t,n),G(l,o,n),u=!0},i(l){u||(V(e.$$.fragment,l),u=!0)},o(l){$(e.$$.fragment,l),u=!1},d(l){l&&(v(t),v(o)),bt(e,l)}}}function Tt(p){let e,t,o,a,u,l="Set Your Location",n,c,A=`NearMe is a location-based community app. Please select your location on the map below.
          All content will be restricted to a 15km radius around your location.`,O,y,q,_,w,Y="Location Name (Optional)",F,b,r,d,P="Give your location a name for easier identification",K,D,C,x,k,J,Q,S,Z,tt,T,ot=`<div class="flex items-center"><div class="flex-shrink-0 text-warning-500"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm text-gray-700 dark:text-gray-300">Your location will be used to show relevant community content within a 15km radius.
              You&#39;ll only need to set this once.</p></div></div>`,U,et,st,f=!p[4]&&ht();const rt=[Pt,Dt],z=[];function it(m,L){return m[3]?0:1}return x=it(p),k=z[x]=rt[x](p),{c(){e=h("div"),t=h("div"),o=h("div"),a=h("div"),u=h("h1"),u.textContent=l,n=N(),c=h("p"),c.textContent=A,O=N(),y=h("div"),f&&f.c(),q=N(),_=h("div"),w=h("label"),w.textContent=Y,F=N(),b=h("input"),r=N(),d=h("p"),d.textContent=P,K=N(),D=h("div"),C=h("button"),k.c(),Q=N(),S=h("button"),Z=_t("Cancel"),tt=N(),T=h("div"),T.innerHTML=ot,this.h()},l(m){e=g(m,"DIV",{class:!0});var L=M(e);t=g(L,"DIV",{class:!0});var B=M(t);o=g(B,"DIV",{class:!0});var X=M(o);a=g(X,"DIV",{class:!0});var I=M(a);u=g(I,"H1",{class:!0,"data-svelte-h":!0}),j(u)!=="svelte-161houy"&&(u.textContent=l),n=E(I),c=g(I,"P",{class:!0,"data-svelte-h":!0}),j(c)!=="svelte-tb0lia"&&(c.textContent=A),O=E(I),y=g(I,"DIV",{class:!0});var ct=M(y);f&&f.l(ct),ct.forEach(v),q=E(I),_=g(I,"DIV",{class:!0});var H=M(_);w=g(H,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),j(w)!=="svelte-tb3t2y"&&(w.textContent=Y),F=E(H),b=g(H,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),r=E(H),d=g(H,"P",{class:!0,"data-svelte-h":!0}),j(d)!=="svelte-2965ri"&&(d.textContent=P),H.forEach(v),K=E(I),D=g(I,"DIV",{class:!0});var R=M(D);C=g(R,"BUTTON",{class:!0});var ut=M(C);k.l(ut),ut.forEach(v),Q=E(R),S=g(R,"BUTTON",{class:!0});var dt=M(S);Z=vt(dt,"Cancel"),dt.forEach(v),R.forEach(v),I.forEach(v),tt=E(X),T=g(X,"DIV",{class:!0,"data-svelte-h":!0}),j(T)!=="svelte-1e2ai3e"&&(T.innerHTML=ot),X.forEach(v),B.forEach(v),L.forEach(v),this.h()},h(){i(u,"class","text-2xl font-bold text-gray-900 dark:text-white mb-4"),i(c,"class","text-gray-600 dark:text-gray-300 mb-6"),i(y,"class","w-full h-96 rounded-lg overflow-hidden mb-6 bg-gray-100 dark:bg-gray-700"),i(w,"for","locationName"),i(w,"class","label"),i(b,"id","locationName"),i(b,"type","text"),i(b,"placeholder","Home, Work, etc."),i(b,"class","input"),i(d,"class","mt-1 text-sm text-gray-500 dark:text-gray-400"),i(_,"class","mb-6"),i(C,"class","btn btn-primary flex items-center justify-center"),C.disabled=J=p[3]||!p[1],i(S,"class","btn btn-outline"),S.disabled=p[3],i(D,"class","flex space-x-4"),i(a,"class","p-6"),i(T,"class","bg-gray-50 dark:bg-gray-700 px-6 py-4"),i(o,"class","bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden"),i(t,"class","max-w-4xl mx-auto"),i(e,"class","min-h-screen bg-gray-50 dark:bg-gray-900 p-4")},m(m,L){G(m,e,L),s(e,t),s(t,o),s(o,a),s(a,u),s(a,n),s(a,c),s(a,O),s(a,y),f&&f.m(y,null),p[6](y),s(a,q),s(a,_),s(_,w),s(_,F),s(_,b),mt(b,p[2]),s(_,r),s(_,d),s(a,K),s(a,D),s(D,C),z[x].m(C,null),s(D,Q),s(D,S),s(S,Z),s(o,tt),s(o,T),U=!0,et||(st=[at(b,"input",p[7]),at(C,"click",p[5]),at(S,"click",p[8])],et=!0)},p(m,[L]){m[4]?f&&(gt(),$(f,1,1,()=>{f=null}),pt()):f?L&16&&V(f,1):(f=ht(),f.c(),V(f,1),f.m(y,null)),L&4&&b.value!==m[2]&&mt(b,m[2]);let B=x;x=it(m),x!==B&&(gt(),$(z[B],1,1,()=>{z[B]=null}),pt(),k=z[x],k||(k=z[x]=rt[x](m),k.c()),V(k,1),k.m(C,null)),(!U||L&10&&J!==(J=m[3]||!m[1]))&&(C.disabled=J),(!U||L&8)&&(S.disabled=m[3])},i(m){U||(V(f),V(k),U=!0)},o(m){$(f),$(k),U=!1},d(m){m&&v(e),f&&f.d(),p[6](null),z[x].d(),et=!1,Lt(st)}}}function zt(p,e,t){let o;It(p,lt,r=>t(12,o=r));let a,u,l=null,n=null,c="",A=!1,O=!1,y=!1;window.initMap=function(){},Mt(()=>{{const r=localStorage.getItem("userId");if(!r){nt("/");return}lt.setUserId(r);const d=document.createElement("script");d.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_qj85kGT9hBxTy988qafXIGsijaDerII&callback=initMap",d.defer=!0,window.initMap=()=>{t(4,O=!0),q()},document.head.appendChild(d)}});function q(){if(!(!a||y))try{const r={lat:17.385044,lng:78.486671};u=new google.maps.Map(a,{center:r,zoom:12,mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0,zoomControl:!0}),u.addListener("click",d=>{const P=d.latLng;P&&(_(P),t(1,n={lat:P.lat(),lng:P.lng()}))}),y=!0}catch(r){console.error("Error initializing map:",r),W.error("Failed to initialize map. Please refresh the page.")}}function _(r){l&&l.setMap(null),l=new google.maps.Marker({position:r,map:u,animation:google.maps.Animation.DROP,draggable:!0}),l.addListener("dragend",()=>{const d=l==null?void 0:l.getPosition();d&&t(1,n={lat:d.lat(),lng:d.lng()})}),u.panTo(r)}async function w(){if(!n){W.error("Please select a location on the map");return}t(3,A=!0);try{const r=o.userId;if(!r)throw new Error("User ID not found");const d=await fetch("http://localhost:8080/api/location/save",{method:"POST",headers:{"Content-Type":"application/json","X-User-ID":r},body:JSON.stringify({userId:r,latitude:n.lat,longitude:n.lng,locationName:c||"My Location"})});if(!d.ok)throw new Error(`Failed to save location: ${d.status}`);lt.setLocation({latitude:n.lat,longitude:n.lng,locationName:c||"My Location"}),localStorage.setItem("userLocation",JSON.stringify({latitude:n.lat,longitude:n.lng,locationName:c||"My Location"})),W.success("Location saved successfully"),nt("/dashboard")}catch(r){console.error("Error saving location:",r),W.error("Failed to save location. Please try again.")}finally{t(3,A=!1)}}function Y(r){Et[r?"unshift":"push"](()=>{a=r,t(0,a)})}function F(){c=this.value,t(2,c)}return[a,n,c,A,O,w,Y,F,()=>nt("/")]}class Ht extends Nt{constructor(e){super(),St(this,e,zt,Tt,Ct,{})}}export{Ht as component};
